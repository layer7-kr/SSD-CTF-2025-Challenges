# kids

웹 / kid (EASY)

## 컨셉

JWT를 인증에 사용하는 간단한 Flask 앱입니다. 서버는 `kid` 헤더를 파일 시스템 경로로 신뢰하여 공개 키를 로드합니다. 사용자가 임의 파일을 업로드할 수 있기 때문에, 공격자는 자신의 RSA 공개 키를 업로드하고 `kid`를 해당 업로드된 파일로 지정하여 `superadmin`이 되어 플래그를 획득할 수 있습니다.


## 문제 설명 (참가자용)

- 아무리봐도 GPT로 대충만든 서버네요
- 그러면 취약점이 분명히 있을 것 같은데요?
플래그 형식: `SSD{...}`

## 익스플로잇

1. 회원가입 및 로그인하여 기본 사용자 토큰을 획득합니다 (아무 사용자나 가능).
2. 로컬에서 RSA 키 쌍을 생성합니다.
3. 공개 키를 아바타로 업로드하고 반환된 파일 경로를 확인합니다.
4. `sub=superadmin`을 가진 JWT를 위조하고 `kid`를 업로드된 아바타 경로로 설정하며 개인 키로 서명합니다.
5. 위조된 토큰으로 `GET /admin`을 호출하여 플래그를 획득합니다.

`for_organizer/exploit/exploit.py`